package graphql.gitlab.model;

import org.eclipse.microprofile.graphql.Name;

import com.fasterxml.jackson.annotation.JsonSubTypes;
import com.fasterxml.jackson.annotation.JsonTypeInfo;

import io.smallrye.graphql.api.Union;
import jakarta.json.bind.annotation.JsonbSubtype;
import jakarta.json.bind.annotation.JsonbTypeInfo;

/**
 * Represents a vulnerability location. The fields with data will depend on the vulnerability report type
 */
@Union
@JsonbTypeInfo(key = "__typename", value = {
        @JsonbSubtype(alias = "VulnerabilityLocationClusterImageScanning", type = VulnerabilityLocationClusterImageScanning.class),
        @JsonbSubtype(alias = "VulnerabilityLocationContainerScanning", type = VulnerabilityLocationContainerScanning.class),
        @JsonbSubtype(alias = "VulnerabilityLocationDast", type = VulnerabilityLocationDast.class),
        @JsonbSubtype(alias = "VulnerabilityLocationDependencyScanning", type = VulnerabilityLocationDependencyScanning.class),
        @JsonbSubtype(alias = "VulnerabilityLocationSast", type = VulnerabilityLocationSast.class),
        @JsonbSubtype(alias = "VulnerabilityLocationSecretDetection", type = VulnerabilityLocationSecretDetection.class)
})
@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.EXISTING_PROPERTY, property = "__typename")
@JsonSubTypes({
        @JsonSubTypes.Type(name = "VulnerabilityLocationClusterImageScanning", value = VulnerabilityLocationClusterImageScanning.class),
        @JsonSubTypes.Type(name = "VulnerabilityLocationContainerScanning", value = VulnerabilityLocationContainerScanning.class),
        @JsonSubTypes.Type(name = "VulnerabilityLocationDast", value = VulnerabilityLocationDast.class),
        @JsonSubTypes.Type(name = "VulnerabilityLocationDependencyScanning", value = VulnerabilityLocationDependencyScanning.class),
        @JsonSubTypes.Type(name = "VulnerabilityLocationSast", value = VulnerabilityLocationSast.class),
        @JsonSubTypes.Type(name = "VulnerabilityLocationSecretDetection", value = VulnerabilityLocationSecretDetection.class)
})
@Name("VulnerabilityLocation")
public interface VulnerabilityLocation {
}
